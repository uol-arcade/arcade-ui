/* enki js, @author: Benjamin Williams */
function showNotification(e,t){$(".notification h1").html(e),$(".notification p").html(t),$(".notification").show(),setTimeout(function(){$(".notification").hide()},5e3)}var AudioManager=function(){};AudioManager.moveSound=new Audio("assets/audio/blip-high.wav"),AudioManager.backSound=new Audio("assets/audio/blip-low.wav"),AudioManager.selectSound=new Audio("assets/audio/powerup.wav"),AudioManager.playMove=function(){AudioManager.moveSound.pause(),AudioManager.moveSound.currentTime=0,AudioManager.moveSound.play()},AudioManager.playBack=function(){AudioManager.backSound.pause(),AudioManager.backSound.currentTime=0,AudioManager.backSound.play()},AudioManager.playSelect=function(){AudioManager.selectSound.pause(),AudioManager.selectSound.currentTime=0,AudioManager.selectSound.play()};var CheatDetector=function(){window.addEventListener("keydown",this.onKeyDown.bind(this)),this.cheats=[],this.map=[]};CheatDetector.prototype.mapKey=function(e,t){if("string"==typeof e)this.map.push({char:e,key:t});else if(void 0!==e.length&&void 0!==t.length)for(var a=0;a<e.length;a++)this.map.push({char:e[a],key:t[a]});return this},CheatDetector.prototype.onKeyDown=function(e){for(var t=String.fromCharCode(e.keyCode).toLowerCase(),a=0;a<this.map.length;a++)this.map[a].key==e.keyCode&&(t=this.map[a].char);for(a=0;a<this.cheats.length;a++)this.processCheat(t,this.cheats[a])},CheatDetector.prototype.onCheat=function(e,t){this.cheats.push({code:e.toLowerCase(),counter:0,name:"n/a",callback:t})},CheatDetector.prototype.onCheatEx=function(e,t,a){this.cheats.push({code:e.toLowerCase(),name:t,counter:0,callback:a})},CheatDetector.prototype.processCheat=function(e,t){e==t.code[t.counter]?(t.counter++,t.counter>=t.code.length&&(t.counter=0,t.callback({code:t.code,name:t.name}))):t.counter=0};var cheatDetector=new CheatDetector;cheatDetector.mapKey(["a","b","c","d","e","f"],[70,71,72,74,75,76]),cheatDetector.onCheat("deadbeef",function(e){console.log("deadbeef"),document.querySelector(".debug.screen").classList.toggle("hidden")}),cheatDetector.onCheat("cafe",function(e){console.log("cafe"),document.querySelector(".version-info").classList.toggle("hidden")}),Math.clamp=((e,t,a)=>Math.max(t,Math.min(e,a))),Math.randomRange=((e,t)=>e+Math.random()*(t-e)),arcade.launchGame=function(e,t=0){setTimeout(function(){window.location.href="games/"+e},t)},arcade.keys={},arcade.keys.currentListener=null,arcade.keys.keyLeftEvent=new Event("keyLeft"),arcade.keys.keyRightEvent=new Event("keyRight"),arcade.keys.keyUpEvent=new Event("keyUp"),arcade.keys.keyDownEvent=new Event("keyDown"),arcade.keys.keyAEvent=new Event("keyA"),arcade.keys.keyBEvent=new Event("keyB"),arcade.keys.keyStartEvent=new Event("keyStart"),arcade.keys.keyExitEvent=new Event("keyExit"),arcade.keys.dispatchEvents=(e=>{null!=arcade.keys.currentListener&&(arcade.keys.currentListener=document.querySelector("."+ScreenSelector.currentScreen+".screen"),"ArrowLeft"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyLeftEvent):"ArrowRight"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyRightEvent):"ArrowUp"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyUpEvent):"ArrowDown"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyDownEvent):"KeyZ"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyAEvent):"KeyX"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyBEvent):"KeyQ"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyExitEvent):"Enter"==e.code&&arcade.keys.currentListener.dispatchEvent(arcade.keys.keyStartEvent))}),arcade.keys.on=((e,t,a)=>{t.addEventListener(e,a)}),window.addEventListener("keydown",arcade.keys.dispatchEvents.bind(this)),window.addEventListener("load",()=>{ScreenSelector.setScreen("start")});class PressEffect{constructor(e){this.elem=e,this.spawn(e)}spawn(e){let t=document.createElement("section");t.classList.add("pressed"),e.style.position="relative",this.childElem=e.appendChild(t);let a=10;t.style.marginTop=Math.randomRange(-a,a)+"px",t.style.marginLeft=Math.randomRange(-a,a)+"px",setTimeout(function(){this.childElem.remove()}.bind(this),1e3)}}PressEffect.spawn=function(e){return new PressEffect(e)},arcade.buildMenuOnlyExitable=(e=>({el:e,mounted:function(){arcade.keys.on("keyB",this.$el,this.back)},methods:{back:()=>ScreenSelector.setScreen("menu")}})),window.addEventListener("load",e=>{arcade.vue_about=new Vue({el:".about.screen",data:{qr_path:"assets/images/qr.png",html:"Loading..."},mounted:function(){this.qr_path=arcade.about.qr_path,this.html=arcade.about.html,arcade.keys.on("keyB",this.$el,this.back)},methods:{back:()=>{ScreenSelector.setScreen("menu"),AudioManager.playBack()}}}),arcade.vue_credits=new Vue({el:".credits.screen",data:{credits:{},credits_header:"Loading..."},mounted:function(){this.credits=arcade.credits.credits,this.credits_header=arcade.credits.credits_header,arcade.keys.on("keyB",this.$el,this.back)},methods:{back:()=>{ScreenSelector.setScreen("menu"),AudioManager.playBack()}}})}),window.addEventListener("load",e=>{arcade.vue_games=new Vue({el:".games.screen",data:{currentIndex:0,games:[{title:"Adi's Maze Unlimited",genre:"Platformer",players:2,imagePath:"assets/images/adis-maze.png",author:"Benjamin Williams",description:"Lorem ipsum dolor, sit amet consectetur elit. Sunt a mazime iste.",path:"pacman-unlimited"}]},mounted:function(){this.games=arcade.games,arcade.keys.on("keyLeft",this.$el,this.left),arcade.keys.on("keyRight",this.$el,this.right),arcade.keys.on("keyA",this.$el,this.A),arcade.keys.on("keyB",this.$el,this.B)},methods:{transitionOut(e){let t=document.querySelector(".game");t.classList.contains("transitionIn")||t.classList.contains("transitionOut")||(t.classList.toggle("transitionOut"),window.setTimeout(e.bind(this),600))},transitionIn(e){let t=document.querySelector(".game");t.classList.toggle("transitionOut"),t.classList.toggle("transitionIn"),window.setTimeout(()=>{t.classList.toggle("transitionIn")},1e3)},A(){let e=this.$el.querySelector(".key.info.primary kbd");PressEffect.spawn(e),arcade.launchGame(this.currentGame.path,500),AudioManager.playSelect()},B(){this.$el.querySelector(".key.info.secondary kbd"),ScreenSelector.setScreen("menu"),AudioManager.playBack()},left(){0!=this.currentIndex?(PressEffect.spawn(document.querySelector(".chevron.left span")),this.transitionOut(function(){this.currentIndex--,this.transitionIn()}),AudioManager.playMove()):AudioManager.playBack()},right(){this.currentIndex!=this.games.length-1?(PressEffect.spawn(document.querySelector(".chevron.right span")),this.transitionOut(function(){this.currentIndex++,this.transitionIn()}),AudioManager.playMove()):AudioManager.playBack()}},computed:{currentGame(){return this.games[this.currentIndex]}},filters:{formatPlayers:e=>1==e?e+" player":e>1?"1-"+e+" players":void 0}})}),window.addEventListener("load",e=>{arcade.vue_menu=new Vue({el:".menu.screen",data:{currentIndex:0,items:[{title:"Games",target:"games"},{title:"Credits",target:"credits"},{title:"About",target:"about"}]},mounted:function(){let e=document.querySelector(".menu.screen");arcade.keys.on("keyA",e,this.selectItem),arcade.keys.on("keyStart",e,this.selectItem),arcade.keys.on("keyUp",e,this.moveUp),arcade.keys.on("keyDown",e,this.moveDown),arcade.keys.on("keyExit",e,this.back),arcade.keys.on("keyB",e,this.back)},methods:{back(){ScreenSelector.setScreen("start"),AudioManager.playBack()},moveDown(){this.currentIndex=(this.currentIndex+1)%this.items.length,AudioManager.playMove()},moveUp(){this.currentIndex-1<0?this.currentIndex=this.items.length-1:this.currentIndex=this.currentIndex-1,document.querySelector(".menu.screen li.active"),AudioManager.playMove()},selectItem(e){let t=this.items[this.currentIndex].target;document.querySelector(".menu.screen li.active"),ScreenSelector.setScreen(t),AudioManager.playSelect()}}})});var ScreenSelector={currentScreen:"start",setScreen:function(e){ScreenSelector.currentScreen=e;var t=document.querySelector("."+e+".screen"),a=document.querySelectorAll(".screen");for(var n of a)n.classList.add("hidden");t.classList.remove("hidden"),arcade.keys.currentListener=ScreenSelector.currentScreen}};window.addEventListener("load",e=>{arcade.vue_start=new Vue({el:".start.screen",data:{},mounted:function(){let e=document.querySelector(".start.screen");arcade.keys.on("keyStart",e,this.startPressed)},methods:{startPressed(){AudioManager.playSelect(),ScreenSelector.setScreen("menu")}}})});class VideoCarousel{constructor(){this.timerUpdateDelay=.5,this.timerID=-1,this.videoIndex=0,this.pauseIndex=0,this.videoSeconds=0,this.setupTimer(),this.paused=!1,this.changeBackground(0)}changeBackground(e=1){this.videoIndex=(this.videoIndex+e)%arcade.videos.length,this.videoElement.pause(),this.sourceElement.setAttribute("src",arcade.videos[this.videoIndex].path),this.videoElement.load(),this.videoElement.play()}setupTimer(){clearInterval(this.timerID),this.timerID=window.setInterval(this.timerUpdate.bind(this),1e3*this.timerUpdateDelay),this.videoElement.addEventListener("ended",this.onVideoEnded.bind(this))}onVideoEnded(){this.changeBackground(1),this.paused=!1,this.pauseIndex=0,this.videoSeconds=0}updatePauseState(){this.paused?document.querySelector(".start.screen").style.display="none":document.querySelector(".start.screen").style.display="block",this.pauseIndex>=this.pauses.length||(this.videoSeconds>=this.pauses[this.pauseIndex][0]&&(this.paused||(this.paused=!0)),this.videoSeconds>=this.pauses[this.pauseIndex][1]&&this.paused&&(this.paused=!1,this.pauseIndex++))}timerUpdate(){this.updatePauseState(),this.videoSeconds+=this.timerUpdateDelay}get pauses(){return arcade.videos[this.videoIndex].pauses}get currentPath(){return arcade.videos[this.videoIndex].path}get videoElement(){return document.querySelector("#background-video")}get sourceElement(){return document.querySelector("#background-video > source")}}window.addEventListener("load",()=>{let e=new VideoCarousel;console.log(e)});