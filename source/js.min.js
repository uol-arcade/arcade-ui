/* enki js, @author: Benjamin Williams */
function showNotification(e,t){$(".notification h1").html(e),$(".notification p").html(t),$(".notification").show(),setTimeout(function(){$(".notification").hide()},5e3)}var CheatDetector=function(){window.addEventListener("keydown",this.onKeyDown.bind(this)),this.cheats=[],this.map=[]};CheatDetector.prototype.mapKey=function(e,t){if("string"==typeof e)this.map.push({char:e,key:t});else if(void 0!==e.length&&void 0!==t.length)for(var n=0;n<e.length;n++)this.map.push({char:e[n],key:t[n]});return this},CheatDetector.prototype.onKeyDown=function(e){for(var t=String.fromCharCode(e.keyCode).toLowerCase(),n=0;n<this.map.length;n++)this.map[n].key==e.keyCode&&(t=this.map[n].char);for(n=0;n<this.cheats.length;n++)this.processCheat(t,this.cheats[n])},CheatDetector.prototype.onCheat=function(e,t){this.cheats.push({code:e.toLowerCase(),counter:0,name:"n/a",callback:t})},CheatDetector.prototype.onCheatEx=function(e,t,n){this.cheats.push({code:e.toLowerCase(),name:t,counter:0,callback:n})},CheatDetector.prototype.processCheat=function(e,t){e==t.code[t.counter]?(t.counter++,t.counter>=t.code.length&&(t.counter=0,t.callback({code:t.code,name:t.name}))):t.counter=0};var cheatDetector=new CheatDetector;cheatDetector.mapKey(["a","b","c","d","e","f"],[70,71,72,74,75,76]),cheatDetector.onCheat("deadbeef",function(e){console.log("deadbeef"),document.querySelector(".debug.screen").classList.toggle("hidden")}),cheatDetector.onCheat("cafe",function(e){console.log("cafe"),document.querySelector(".version-info").classList.toggle("hidden")}),Math.clamp=((e,t,n)=>Math.max(t,Math.min(e,n))),Math.randomRange=((e,t)=>e+Math.random()*(t-e)),arcade.launchGame=function(e,t=0){setTimeout(function(){window.location.href="games/"+e},t)},arcade.keys={},arcade.keys.currentListener=null,arcade.keys.keyLeftEvent=new Event("keyLeft"),arcade.keys.keyRightEvent=new Event("keyRight"),arcade.keys.keyUpEvent=new Event("keyUp"),arcade.keys.keyDownEvent=new Event("keyDown"),arcade.keys.keyAEvent=new Event("keyA"),arcade.keys.keyBEvent=new Event("keyB"),arcade.keys.keyStartEvent=new Event("keyStart"),arcade.keys.keyExitEvent=new Event("keyExit"),arcade.keys.dispatchEvents=(e=>{null!=arcade.keys.currentListener&&(arcade.keys.currentListener=document.querySelector("."+ScreenSelector.currentScreen+".screen"),"ArrowLeft"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyLeftEvent):"ArrowRight"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyRightEvent):"ArrowUp"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyUpEvent):"ArrowDown"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyDownEvent):"KeyZ"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyAEvent):"KeyX"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyBEvent):"KeyQ"==e.code?arcade.keys.currentListener.dispatchEvent(arcade.keys.keyExitEvent):"Enter"==e.code&&arcade.keys.currentListener.dispatchEvent(arcade.keys.keyStartEvent))}),arcade.keys.on=((e,t,n)=>{t.addEventListener(e,n)}),window.addEventListener("keydown",arcade.keys.dispatchEvents.bind(this)),window.addEventListener("load",()=>{ScreenSelector.setScreen("start")});class PressEffect{constructor(e){this.elem=e,this.spawn(e)}spawn(e){let t=document.createElement("section");t.classList.add("pressed"),e.style.position="relative",this.childElem=e.appendChild(t);let n=10;t.style.marginTop=Math.randomRange(-n,n)+"px",t.style.marginLeft=Math.randomRange(-n,n)+"px",setTimeout(function(){this.childElem.remove()}.bind(this),1e3)}}PressEffect.spawn=function(e){return new PressEffect(e)},arcade.buildMenuOnlyExitable=(e=>({el:e,mounted:function(){arcade.keys.on("keyB",this.$el,this.back)},methods:{back:()=>ScreenSelector.setScreen("menu")}})),window.addEventListener("load",e=>{arcade.vue_about=new Vue({el:".about.screen",data:{qr_path:"assets/images/qr.png",html:"Loading..."},mounted:function(){this.qr_path=arcade.about.qr_path,this.html=arcade.about.html,arcade.keys.on("keyB",this.$el,this.back)},methods:{back:()=>ScreenSelector.setScreen("menu")}}),arcade.vue_credits=new Vue({el:".credits.screen",data:{credits:{},credits_header:"Loading..."},mounted:function(){this.credits=arcade.credits.credits,this.credits_header=arcade.credits.credits_header,arcade.keys.on("keyB",this.$el,this.back)},methods:{back:()=>ScreenSelector.setScreen("menu")}})}),window.addEventListener("load",e=>{arcade.vue_games=new Vue({el:".games.screen",data:{currentIndex:0,games:[{title:"Adi's Maze Unlimited",genre:"Platformer",players:2,imagePath:"assets/images/adis-maze.png",author:"Benjamin Williams",description:"Lorem ipsum dolor, sit amet consectetur elit. Sunt a mazime iste.",path:"pacman-unlimited"}]},mounted:function(){this.games=arcade.games,arcade.keys.on("keyLeft",this.$el,this.left),arcade.keys.on("keyRight",this.$el,this.right),arcade.keys.on("keyA",this.$el,this.A),arcade.keys.on("keyB",this.$el,this.B)},methods:{transitionOut(e){let t=document.querySelector(".game");t.classList.contains("transitionIn")||t.classList.contains("transitionOut")||(t.classList.toggle("transitionOut"),window.setTimeout(e.bind(this),600))},transitionIn(e){let t=document.querySelector(".game");t.classList.toggle("transitionOut"),t.classList.toggle("transitionIn"),window.setTimeout(()=>{t.classList.toggle("transitionIn")},1e3)},A(){let e=this.$el.querySelector(".key.info.primary kbd");PressEffect.spawn(e),arcade.launchGame(this.currentGame.path,500)},B(){this.$el.querySelector(".key.info.secondary kbd"),ScreenSelector.setScreen("menu")},left(){0!=this.currentIndex&&(PressEffect.spawn(document.querySelector(".chevron.left span")),this.transitionOut(function(){this.currentIndex--,this.transitionIn()}))},right(){this.currentIndex!=this.games.length-1&&(PressEffect.spawn(document.querySelector(".chevron.right span")),this.transitionOut(function(){this.currentIndex++,this.transitionIn()}))}},computed:{currentGame(){return this.games[this.currentIndex]}},filters:{formatPlayers:e=>1==e?e+" player":e>1?"1-"+e+" players":void 0}})}),window.addEventListener("load",e=>{arcade.vue_menu=new Vue({el:".menu.screen",data:{currentIndex:0,items:[{title:"Games",target:"games"},{title:"Credits",target:"credits"},{title:"About",target:"about"}]},mounted:function(){let e=document.querySelector(".menu.screen");arcade.keys.on("keyA",e,this.selectItem),arcade.keys.on("keyStart",e,this.selectItem),arcade.keys.on("keyUp",e,this.moveUp),arcade.keys.on("keyDown",e,this.moveDown),arcade.keys.on("keyExit",e,this.back),arcade.keys.on("keyB",e,this.back)},methods:{back(){ScreenSelector.setScreen("start")},moveDown(){this.currentIndex=(this.currentIndex+1)%this.items.length},moveUp(){this.currentIndex-1<0?this.currentIndex=this.items.length-1:this.currentIndex=this.currentIndex-1,document.querySelector(".menu.screen li.active")},selectItem(e){let t=this.items[this.currentIndex].target;document.querySelector(".menu.screen li.active"),ScreenSelector.setScreen(t)}}})});var ScreenSelector={currentScreen:"start",setScreen:function(e){ScreenSelector.currentScreen=e;var t=document.querySelector("."+e+".screen"),n=document.querySelectorAll(".screen");for(var r of n)r.classList.add("hidden");t.classList.remove("hidden"),arcade.keys.currentListener=ScreenSelector.currentScreen}};window.addEventListener("load",e=>{arcade.vue_start=new Vue({el:".start.screen",data:{},mounted:function(){let e=document.querySelector(".start.screen");arcade.keys.on("keyStart",e,this.startPressed)},methods:{startPressed(){ScreenSelector.setScreen("menu")}}})});