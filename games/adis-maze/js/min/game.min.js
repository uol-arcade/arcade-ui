var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");
var character,walls=[],grid=[],coinMap=[],cursors,scoreText,score=0,enemies=[],pickedUpCoins=0,originalCoinAmount=0,progressBar,nextDirection=[],lives=3,game=new Phaser.Game(GameSettings.width,GameSettings.height,Phaser.CANVAS,GameSettings.canvasName,{preload:preload,create:start,update:update,render:render},null,!1,!0),playerPos={x:1,y:1},switchSpriteTimer=null,characterSpeed=1.1,playerDirection={x:0,y:0};
function getNeighbours(a,b){return{up:grid[get1DFrom2D(a,b-1)],down:grid[get1DFrom2D(a,b+1)],left:grid[get1DFrom2D(a-1,b)],right:grid[get1DFrom2D(a+1,b)]}}
function preload(){game.started=!1;game.load.image("black","img/black.png");game.load.image("logo","img/logo.png");game.load.image("tile","img/tile.png");game.load.image("coin","img/coin.png");game.load.image("small-coin","img/small-coin.png");game.load.image("progress-bg","img/progress-bar-bg.png");game.load.image("progress-fg","img/progress-bar-fg.png");game.load.spritesheet("player","img/character.png",24,24);game.load.spritesheet("player-scream","img/character-scream.png",24,24);game.load.spritesheet("explosion",
"img/explosion2.png",32,32);game.load.spritesheet("smoke","img/smoke.png",32,32);game.load.spritesheet("enemy1","img/enemy-1.png",24,24);game.load.spritesheet("enemy2","img/enemy-2.png",24,24);game.load.spritesheet("enemy3","img/enemy-3.png",24,24);game.load.spritesheet("enemy4","img/enemy-4.png",24,24);game.load.spritesheet("enemy5","img/enemy-5.png",24,24);game.load.audio("small-coin","sound/small-coin.wav");game.load.audio("coin","sound/coin.wav");game.load.audio("coin2","sound/coin2.wav");game.load.audio("coin-pitch-1",
"sound/coin-pitch-1.wav");game.load.audio("coin-pitch-2","sound/coin-pitch-2.wav");game.load.audio("coin-pitch-3","sound/coin-pitch-3.wav");game.load.audio("coin-pitch-4","sound/coin-pitch-4.wav");game.load.audio("explosion","sound/explosion.wav");game.load.audio("powerup","sound/powerup.wav");game.load.audio("blip","sound/blip.wav");game.load.audio("music","sound/music.mp3");game.load.audio("game-over","sound/game-over.wav");game.load.audio("win","sound/win.wav")}
function makeTiles(){grid=Array(GameSettings.cols*GameSettings.rows).fill(0);grid=generateMaze(grid);for(var a=0;a<GameSettings.rows;a++)grid[get1DFrom2D(a,0)]=grid[get1DFrom2D(a,GameSettings.rows-1)]=1;for(a=1;a<GameSettings.rows-1;a++)grid[get1DFrom2D(a,1)]=grid[get1DFrom2D(a,GameSettings.rows-2)]=0;for(a=0;a<GameSettings.cols;a++)grid[get1DFrom2D(0,a)]=grid[get1DFrom2D(GameSettings.rows-1,a)]=1;for(a=1;a<GameSettings.cols-1;a++)grid[get1DFrom2D(1,a)]=grid[get1DFrom2D(GameSettings.cols-2,a)]=0;
for(a=0;a<grid.length;a++)if(0!=grid[a]){var b=GameSettings.width/GameSettings.cols,c=GameSettings.height/GameSettings.rows,d=game.add.sprite(Math.floor(a%GameSettings.cols)*b,Math.floor(a/GameSettings.cols)*c,"tile");d.width=b;d.height=c;walls.push(d)}}
function addCoins(){for(var a=get1DFrom2D(playerPos.x,playerPos.y),b=0;b<grid.length;b++)if(b==a||0!=grid[b])coinMap[b]={data:0};else{var c=get2DFrom1D(b),d=worldToGrid(c.x,c.y),e;3<=getNeighbourScore(d.x,d.y)?(e=game.add.sprite(c.x,c.y,"coin"),coinMap[b]={data:2,sprite:e}):(e=game.add.sprite(c.x,c.y,"small-coin"),coinMap[b]={data:1,sprite:e});originalCoinAmount++;e.anchor.x=e.anchor.y=.5}}
function getNeighbourScore(a,b){a=getNeighbours(a,b);b=0;if(!(0!=a.up&&0!=a.down||0!=a.left&&0!=a.right))return 3;1==a.up&&b++;1==a.left&&b++;1==a.down&&b++;1==a.right&&b++;return b}function placeCharacter(){for(getNeighbours(playerPos.x,playerPos.y);;){var a=Math.floor(1+Math.random()*(GameSettings.cols-2)),b=Math.floor(1+Math.random()*(GameSettings.rows-2));if((1!=a||1!=b)&&0==grid[get1DFrom2D(a,b)]){playerPos={x:a,y:b};character.position=gridToWorld(a,b);break}}}
var coinSounds=[],smallCoinSound,explodeSound,powerupSound,blipSound,music,winSound,gameoverSound,gamepad,graph,vertices,logger=new Logger;function destroyLoadingScreen(){var a=document.getElementsByClassName("loading-screen")[0];"undefined"!=typeof a&&a.parentNode.removeChild(a)}
function start(){destroyLoadingScreen();Math.seedrandom(seed);music=game.add.audio("music");winSound=game.add.audio("win");gameoverSound=game.add.audio("game-over");game.ended=!1;game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE;game.scale.setUserScale(2,2);initGamepad();grid=[];coinMap=[];coinSounds.push(game.add.audio("coin-pitch-1"));coinSounds.push(game.add.audio("coin-pitch-2"));coinSounds.push(game.add.audio("coin-pitch-3"));coinSounds.push(game.add.audio("coin-pitch-4"));smallCoinSound=game.add.audio("coin-small");
explodeSound=game.add.audio("explosion");powerupSound=game.add.audio("powerup");blipSound=game.add.audio("blip");game.renderer.renderSession.roundPixels=!0;Phaser.Canvas.setImageRenderingCrisp(game.canvas);game.stage.backgroundColor="#222";var a=gridToWorld(playerPos.x,playerPos.y);cursors=game.input.keyboard.createCursorKeys();character=game.add.sprite(a.x,a.y,"player");character.anchor.x=.5;character.anchor.y=.5;character.animations.add("walk");character.play("walk",12,!0);Phaser.Canvas.setSmoothingEnabled(game.context,
!1);makeTiles();placeCharacter();addCoins();a=buildGraph(grid);graph=a.graph;vertices=a.vertices;addEnemies();scoreText=game.add.text(32,4," ",{font:"12px Press Start 2P",fill:"#000",align:"left"});a=GameSettings.progressThickness;var b=GameSettings.width-32-GameSettings.progressWidth+a,c=(16-GameSettings.progressHeight)/2+2*a,d=game.add.sprite(b-a,c-a,"progress-bg");d.width=GameSettings.progressWidth;d.height=GameSettings.progressHeight;progressBar=game.add.sprite(b,c,"progress-fg");progressBar.width=
GameSettings.progressWidth-2*a;progressBar.height=GameSettings.progressHeight-2*a;setProgress(0);game.world.bringToTop(enemyGroup);createStartMenu()}function setProgress(a){progressBar.width=(GameSettings.progressWidth-2*GameSettings.progressThickness)*a}function changeDirection(a,b){nextDirection=[a,b]}var isInterpolating=!1;
function moveCharacter(){var a=get1DFrom2D(playerPos.x+playerDirection.x,playerPos.y+playerDirection.y),b=get1DFrom2D(playerPos.x+nextDirection[0],playerPos.y+nextDirection[1]),c=gridToWorld(playerPos.x,playerPos.y),d=Math.abs(character.position.x-c.x)+Math.abs(character.position.y-c.y);0>character.position.y&&endGame();0==grid[b]&&2>d&&nextDirection!=[]&&(character.position.x=c.x,character.position.y=c.y,playerDirection.x=nextDirection[0],playerDirection.y=nextDirection[1],0<playerDirection.x?character.scale.x=
-1:0>playerDirection.x&&(character.scale.x=1),nextDirection=[]);if(0==grid[a]||isInterpolating){if(character.position.x+=playerDirection.x*characterSpeed,character.position.y+=playerDirection.y*characterSpeed,a=playerPos,playerPos=worldToGrid(character.position.x,character.position.y),a.x!=playerPos.x||a.y!=playerPos.y)-1!=getHitJunctionXY(grid,playerPos.x,playerPos.y)&&(a=get1DFrom2D(playerPos.x,playerPos.y),logger.addJunction(a)),logger.addPlayerStep(playerPos.x,playerPos.y)}else isInterpolating=
!0,a=gridToWorld(playerPos.x,playerPos.y),game.add.tween(character).to({x:[a.x],y:[a.y]},100,"Linear",!0).onComplete.add(function(){isInterpolating=!1},this)}
function collectCoins(){if(!game.ended){var a=get1DFrom2D(playerPos.x,playerPos.y);if(0!=coinMap[a].data){var b=gridToWorld(playerPos.x,playerPos.y),c=game.add.sprite(b.x,b.y,"explosion");b=c.animations.add("explode");score+=5*coinMap[a].data;scoreText.setText("SCORE: "+score);c.anchor.x=.5;c.anchor.y=.5;c.scale.x=c.scale.y=Math.random()+1;c.animations.play("explode",24,!1);c.lifespan=1E3;clearTimeout(switchSpriteTimer);switchSpriteTimer=null;setTimeout(function(){game.ended||(character.loadTexture("player",
0),character.animations.play("walk",12,!0))},1E3);"scream"!=character.animations.currentAnim.name&&(character.loadTexture("player-scream",0),character.animations.add("scream"),character.animations.play("scream",12,!0));coinSounds[0].play();explodeSound.play();game.camera.shake(.0025*coinMap[a].data,50*coinMap[a].data);b.onComplete.add(function(){c.destroy()},this);coinMap[a].sprite.destroy();coinMap[a].data=0;setProgress(++pickedUpCoins/originalCoinAmount);1<=pickedUpCoins/originalCoinAmount&&winGame()}}}
function update(){game.started?game.ended?endGameInput(cursors):game.won?wonGameInput(cursors):(moveEnemies(),handleGamepad(),cursors.up.downDuration(1)?changeDirection(0,-1):cursors.down.downDuration(1)?changeDirection(0,1):cursors.left.downDuration(10)?changeDirection(-1,0):cursors.right.downDuration(10)&&changeDirection(1,0),moveCharacter(),collectCoins(),drawProgress()):startGameInput(cursors)}function moveEnemies(){for(var a=0;a<enemies.length;a++)updateEnemy(grid,enemies[a])}
function drawProgress(){}function render(){};
